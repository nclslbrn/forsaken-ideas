!function(e){"use strict";function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var n=t(e);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function c(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var d=.5*(Math.sqrt(3)-1),m=(3-Math.sqrt(3))/6,f=function(e){return 0|Math.floor(e)},v=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function p(e){void 0===e&&(e=Math.random);var t=function(e){for(var t=512,n=new Uint8Array(t),r=0;r<t/2;r++)n[r]=r;for(var i=0;i<t/2-1;i++){var a=i+~~(e()*(256-i)),o=n[i];n[i]=n[a],n[a]=o}for(var c=256;c<t;c++)n[c]=n[c-256];return n}(e),n=new Float64Array(t).map((function(e){return v[e%12*2]})),r=new Float64Array(t).map((function(e){return v[e%12*2+1]}));return function(e,i){var a,o,c=0,s=0,l=0,u=(e+i)*d,h=f(e+u),v=f(i+u),p=(h+v)*m,y=e-(h-p),w=i-(v-p);y>w?(a=1,o=0):(a=0,o=1);var b=y-a+m,g=w-o+m,M=y-1+2*m,C=w-1+2*m,j=255&h,O=255&v,E=.5-y*y-w*w;if(E>=0){var S=j+t[O];c=(E*=E)*E*(n[S]*y+r[S]*w)}var x=.5-b*b-g*g;if(x>=0){var P=j+a+t[O+o];s=(x*=x)*x*(n[P]*b+r[P]*g)}var k=.5-M*M-C*C;if(k>=0){var z=j+1+t[O+1];l=(k*=k)*k*(n[z]*M+r[z]*C)}return 70*(c+s+l)}}var y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.octaves=void 0===t.octaves?4:t.octaves,this.lacunarity=void 0===t.lacunarity?2:t.lacunarity,this.gain=void 0===t.gain?.5:t.gain,this.amplitude=void 0===t.amplitude?.8:t.amplitude,this.frequency=void 0===t.frequency?.01:t.frequency,this.simplex=p()}return c(e,[{key:"fbm",value:function(e,t,n){for(var r=this.frequency,i=this.amplitude,a=Math.sin(.5),o=Math.cos(.5),c=0,s=0,l=0;l<this.octaves;l++)c=e,e=e*a+t*o,t=-c*o+t*a,s+=i*(2*this.simplex(r*e,r*t,r*n)-1),r*=this.lacunarity,i*=this.gain;return s}},{key:"f",value:function(e,t,n){var r=this.fbm(e,t,n);return r=this.fbm(e+32*r,t+32*r,n+32*r),r=this.fbm(e+64*r,t+64*r,n+64*r)}}]),e}(),w=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="";e.options.label&&((n=document.createElement("label")).innerHTML=e.options.label);var r=document.createElement("input");r.type="range",r.min=e.options.min,r.max=e.options.max,r.step=e.options.step,r.value=e.value,t&&(r.name=t);var i=document.createElement("input");return i.type="text",i.value=e.value,r.addEventListener("change",(function(t){e.value=Number(t.target.value),i.value=t.target.value,console.log(e.callback),"undefined"!==e.callback&&e.callback()})),[n,r,i]},b=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"dark",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;a(this,e),this.elem=document.createElement("p"),this.elem.id="notification","dark"==i||"light"==i?this.elem.classList.add(i):console.error("Undefined mode (".concat(i,"), possible options: dark & light.")),this.elem.innerHTML=t,void 0!==n?(this.parentElem=n,n.appendChild(this.elem),o&&window.setTimeout((function(){n.removeChild(r.elem)}),o)):(this.parentElem=!1,console.error("Parent elem doesn't exist."))}return c(e,[{key:"remove",value:function(){this.parentElem&&this.parentElem.removeChild(this.elem)}}]),e}(),g=document.getElementById("windowFrame"),M={resolution:{value:110,options:{min:30,max:180,step:1,label:"Resolution"}},builds:{value:50,options:{min:1,max:100,step:1,label:"Buildings"}}},C=document.createElement("div");for(var j in C.id="interactiveParameter",M){w(i(i({},M[j]),{},{callback:function(){return window.init()}})).forEach((function(e){C.appendChild(e)}))}g.appendChild(C);var O={zRot:0,meshSize:{w:5e3,h:5e3},seed:"superseed",clock:new n.Clock,scene:new n.Scene,camera:new n.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,2e4),renderer:new n.WebGLRenderer({antialias:!0}),exporter:new n.STLExporter,launch:function(){O.scene.background=new n.Color(2899536),O.scene.add(new n.AmbientLight(16777215,.6));var e=[new n.DirectionalLight(16777215,.6),new n.DirectionalLight(16777215,.6)];e[0].position.set(-O.meshSize.w,-O.meshSize.h,O.meshSize.h),e[1].position.set(O.meshSize.w,O.meshSize.h,O.meshSize.h),e.forEach((function(e){O.scene.add(e)})),O.renderer.setPixelRatio(window.devicePixelRatio),O.renderer.setSize(window.innerWidth,window.innerHeight),g.appendChild(O.renderer.domElement),O.camera.position.set(.5*O.meshSize.w,.5*O.meshSize.h,.5*O.meshSize.h),O.camera.lookAt(0,0,0),O.controls=new n.OrbitControls(O.camera,O.renderer.domElement),O.controls.screenSpacePanning=!0,document.addEventListener("keypress",O.onkeypress,!1),window.addEventListener("resize",O.onWindowResize,!1),O.init(),O.animate()},init:function(){if(O.scene.getObjectByName("landscape")){var e=O.scene.getObjectByName("landscape");O.scene.remove(e),new b("Previous landscape was removed.",g,"dark")}var t=function(e,t,n,r){var a=e*t,o=new Uint8Array(a),c=new y({frequency:.03,octaves:7,amplitude:.15,seed:n}),s=100*Math.random(),l=1,u={x:e/2,y:t/2},h=4,d=4,m=Array.from(new Array(r),(function(){return{x:Math.floor(e/2+(Math.random()/4-.125)*e),y:Math.floor(t/2+(Math.random()/4-.125)*t),w:Math.ceil(Math.random()*h),h:Math.ceil(Math.random()*d),d:Math.random()}}));m.push(i(i({},u),{},{w:Math.ceil(Math.random()*h),h:Math.ceil(Math.random()*d),d:Math.random()}));for(var f=0;f<6;f++){for(var v=0;v<a;v++){var p=v%e,w=~~v/e;o[v]+=Math.abs(c.f(p/l,w/l,s)*l*2)}l*=2.5}for(var b=o.reduce((function(e,t){return Math.max(e,t)})),g=o.reduce((function(e,t){return Math.min(e,t)})),M=0;M<a;M++)for(var C=M%e,j=~~M/e,O=0;O<m.length;O++)Math.abs(m[O].x-C)<=m[O].w&&Math.abs(m[O].y-j)<=m[O].h&&(o[M]=(b-g)*m[O].d+g);return o}(M.resolution.value,M.resolution.value,O.seed,M.builds.value);O.geometry=new n.PlaneGeometry(O.meshSize.w,O.meshSize.h,M.resolution.value-1,M.resolution.value-1),O.geometry.rotateX(-Math.PI/2);for(var r=O.geometry.attributes.position.array,a=0,o=0,c=r.length;a<c;a++,o+=3)r[o+1]=10*t[a];var s=[new n.MeshBasicMaterial({color:2899536}),new n.MeshBasicMaterial({color:16777215,wireframe:!0,transparent:!0})];O.object=n.SceneUtils.createMultiMaterialObject(O.geometry,s),O.object.name="landscape",O.object.position.set(0,-1500,0),O.scene.add(O.object),O.render()},onWindowResize:function(){O.camera.aspect=window.innerWidth/window.innerHeight,O.camera.updateProjectionMatrix(),O.renderer.setSize(window.innerWidth,window.innerHeight)},onkeypress:function(){console.log(O.camera)},render:function(){O.renderer.render(O.scene,O.camera)},animate:function(){requestAnimationFrame(O.animate),O.zRot+=.003,O.object.rotation.set(0,O.zRot,0),void 0!==O.render&&O.render()},export:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth(),i=e.getDay(),a=e.getHours(),o=e.getMinutes(),c="yard.".concat(t,"-").concat(r,"-").concat(i,"_").concat(a,".").concat(o,".stl"),s=new n.Mesh(O.geometry,new n.MeshBasicMaterial({color:0})),l=O.geometry.clone(!0);s.geometry=l,s.geometry.scale(100/O.meshSize.w,100/O.meshSize.h,100/O.meshSize.h),s.geometry.rotateX(Math.PI/2);var u=O.exporter.parse(s,{binary:!0}),h=document.createElement("a");h.style.display="none",document.body.appendChild(h),h.href=URL.createObjectURL(new Blob([u],{type:"application/octet-stream"},c)),h.download=c,h.click()}},E=[].concat(l("0123456789"),l(":/*|&#@$!<>"),l("{}[]+-_^~%?;()")),S=function(){function e(t){var n=this;a(this,e),this.element=t.element,this.trueText=t.element.innerText||t.element.innerHTML,this.numChar=this.trueText.length,this.effect=t.effect,this.curChar=0,this.biteChar="";for(var r=0;r<this.numChar;r++){var i=this.trueText.substr(r,1);this.biteChar+=i&&" "===i?" ":E[Math.floor(Math.random()*E.length)]}this.element.innerHTML="replace"==this.effect?this.biteChar:"";for(var o=0;o<=this.numChar;o++)setTimeout((function(){"add"===n.effect?n.addChar():"replace"===n.effect&&n.replaceChar()}),45*o)}return c(e,[{key:"replaceChar",value:function(){var e;e=this.curChar+1<this.numChar?E[Math.floor(Math.random()*E.length)]:"";var t=this.trueText.substr(0,this.curChar),n=this.biteChar.substr(this.curChar,this.numChar);this.element.innerHTML=t+e+n,this.element.dataset.text=t+e+n,this.curChar++}},{key:"addChar",value:function(){var e;e=this.curChar+1<this.numChar?E[Math.floor(Math.random()*E.length)]:"";var t=this.trueText.substr(0,this.curChar);this.element.innerHTML=t+e,this.element.dataset.text=t+e,this.curChar++}}]),e}(),x=document.getElementById("windowFrame"),P=document.getElementById("loading");O.launch(),x.removeChild(P),window.infobox=function(){var e=document.getElementById("infobox");null!=e&&e.classList.toggle("active")},window.export=O.export,window.init=O.init,function(){window.openOffFrame=function(){document.body.classList.toggle("openedOffWindow");var e=document.getElementById("projectTitle");new S({element:e,effect:"add"})};var e=document.querySelectorAll("[data-action]");if(void 0!==e)for(var t=function(){var t=e[n].getAttribute("data-action");e[n].addEventListener("click",(function(){var e=window[t];"function"!=typeof e?console.log(t," is not defined"):e()}),!1)},n=0;n<e.length;n++)t()}()}(THREE);
